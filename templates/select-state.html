<!-- select-state.html
-->
{% extends 'base.html' %}

{% block content %}
    <div class="state-selection">
        <form>
            <label for="stateSelect">Select a state to analyse:</label>
            <select id="stateSelect" name="state">
                <!-- Add more options based on the actual state data files -->
            </select>
            <input type="submit" value="Submit">
        </form>
    </div>


    <script>
        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;
            // Update UI to show the install button
            document.getElementById('pwaInstallPrompt').style.display = 'block';
        });

        document.getElementById('installBtn').addEventListener('click', async () => {
            if (!deferredPrompt) return;
            // Show the install prompt
            deferredPrompt.prompt();
            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                console.log('User accepted the install prompt');
            } else {
                console.log('User dismissed the install prompt');
            }
            deferredPrompt = null;
            document.getElementById('pwaInstallPrompt').style.display = 'none';
        });
    </script>

{% endblock %}